<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مراجعة وكويز: الدعامة والحركة - أحياء ثالثة ثانوي</title>
    <!-- تضمين Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* خط "Tajawal" لضمان قراءة جيدة باللغة العربية */
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;800&display=swap');
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f0f4f8; /* خلفية فاتحة ومريحة للعين */
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), padding 0.5s ease;
            padding-right: 1.5rem;
            padding-left: 1.5rem;
        }
        .accordion-item.active .accordion-content {
            max-height: 1200px; /* قيمة أكبر لاستيعاب المحتوى الموسع */
            padding-top: 1rem;
            padding-bottom: 1.5rem;
        }
        /* تنسيقات الأزرار لخيارات الكويز */
        .option-btn {
            @apply flex-grow p-3 mb-2 text-right bg-white border border-gray-300 rounded-lg shadow-sm hover:bg-blue-50 transition duration-150 ease-in-out;
        }
        /* التحديد عند الضغط على الخيار (تم تعزيز التحديد ليكون واضحاً جداً) */
        .option-btn.selected {
             /* جعل الخلفية أغمق لتكون واضحة جداً */
             @apply border-purple-700 ring-4 ring-purple-500 shadow-xl bg-purple-200; 
        }
        .option-btn.correct {
            @apply bg-green-100 border-green-500 font-bold;
        }
        .option-btn.incorrect {
            @apply bg-red-100 border-red-500 font-bold;
        }
        /* تنسيق الإطار الأسود حول السؤال */
        #question-display.active-quiz-frame {
            @apply border-4 border-gray-900 shadow-2xl;
        }
        /* مسافة إضافية بين أقسام المراجعة والكويز */
        #review-container {
            margin-bottom: 3rem;
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-4xl mx-auto">
        <!-- العنوان الرئيسي -->
        <header class="text-center mb-8 p-6 bg-blue-600 shadow-xl rounded-xl text-white">
            <h1 class="text-4xl font-extrabold">مراجعة شاملة: الدعامة والحركة</h1>
            <p class="text-xl mt-2 font-light">أحياء الصف الثالث الثانوي - الفصل الأول</p>
        </header>

        <!-- حاوية المراجعة (Accordion) -->
        <h2 id="review-title" class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">أقسام المراجعة التفصيلية</h2>
        <div id="review-container" class="space-y-4 mb-12">

            <!-- 1. الدعامة في النبات -->
            <div class="accordion-item bg-white rounded-xl shadow-lg border-t-4 border-green-500">
                <button class="accordion-header w-full flex justify-between items-center p-5 text-xl font-extrabold text-gray-800 hover:bg-green-50 transition duration-200 rounded-t-xl" onclick="toggleAccordion(this)">
                    <span>1. الدعامة في النبات: الفسيولوجية والتركيبية</span>
                    <svg class="w-6 h-6 transform transition-transform duration-300 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="accordion-content bg-gray-50 rounded-b-xl text-gray-700">
                    <p class="mb-3 font-bold text-lg text-green-600">أولاً: الدعامة الفسيولوجية (المؤقتة):</p>
                    <ul class="list-disc pr-5 space-y-2 mb-4">
                        <li><strong class="text-blue-700">الآلية:</strong> تعتمد على خاصية الأسموزية؛ حيث يدخل الماء إلى الفجوة العصارية للخلية، فيزداد حجمها ويضغط البروتوبلازم على الجدار الخلوي المرن. </li>
                        <li><strong class="text-blue-700">النتيجة:</strong> يكتسب الجدار حالة من التوتر والانتفاخ مما يكسب الخلية (وكذلك النسيج) صلابة.</li>
                        <li><strong class="text-blue-700">أمثلة:</strong> استقامة سوق وأوراق النباتات العشبية عند الري، وانتفاخ بذور البقوليات الجافة عند وضعها في الماء. تزول بزوال الماء.</li>
                    </ul>
                    <p class="mb-3 font-bold text-lg text-green-600">ثانياً: الدعامة التركيبية (الدائمة):</p>
                    <ul class="list-disc pr-5 space-y-2">
                        <li><strong class="text-blue-700">الآلية:</strong> ترسيب مواد صلبة على جدر الخلايا أو أجزاء منها. تزيد هذه المواد من قوة وصلابة الجدار وتمنع فقدان الماء.</li>
                        <li><strong class="text-blue-700">المواد والأمثلة:</strong>
                            <ol class="list-decimal pr-5 mt-1">
                                <li><strong class="text-purple-700">السليلوز واللجنين:</strong> في الخلايا الكولنشيمية والإسكلرنشيمية لإكسابها الصلابة.</li>
                                <li><strong class="text-purple-700">الكيوتين:</strong> مادة شمعية غير منفذة للماء، تترسب على جدر خلايا البشرة الخارجية للحد من فقدان الماء.</li>
                                <li><strong class="text-purple-700">السيوبرين:</strong> مادة غير منفذة، تترسب في الخلايا الفلينية.</li>
                            </ol>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- 2. الدعامة في الإنسان (الجهاز الهيكلي) -->
            <div class="accordion-item bg-white rounded-xl shadow-lg border-t-4 border-blue-500">
                <button class="accordion-header w-full flex justify-between items-center p-5 text-xl font-extrabold text-gray-800 hover:bg-blue-50 transition duration-200 rounded-t-xl" onclick="toggleAccordion(this)">
                    <span>2. الجهاز الهيكلي في الإنسان (العظام والمفاصل)</span>
                    <svg class="w-6 h-6 transform transition-transform duration-300 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="accordion-content bg-gray-50 rounded-b-xl text-gray-700">
                    <p class="mb-3 font-bold text-lg text-blue-600">يتكون الجهاز الهيكلي (206 عظمة) من الهيكل المحوري والطرفي، بالإضافة إلى الغضاريف والمفاصل والأربطة والأوتار. [Image of الهيكل العظمي البشري]</p>
                    <ul class="list-disc pr-5 space-y-2">
                        <li><strong class="text-red-700">الهيكل المحوري (80 عظمة):</strong> يشمل العمود الفقري (33 فقرة)، والجمجمة، والقفص الصدري (12 زوج ضلوع وعظمة القص). وظيفته الرئيسية هي الحماية والدعم.</li>
                        <li><strong class="text-red-700">الهيكل الطرفي (126 عظمة):</strong> يشمل حزامي الكتف والحوض والأطراف الأربعة. وظيفته الأساسية هي تسهيل الحركة.</li>
                        <li><strong class="text-red-700">المفاصل:</strong>
                            <ul class="list-circle pr-5 mt-1 ml-4">
                                <li><strong class="text-green-700">مفاصل ليفية:</strong> لا تسمح بالحركة (مثل مفاصل الجمجمة).</li>
                                <li><strong class="text-green-700">مفاصل غضروفية:</strong> تسمح بحركة محدودة جداً (مثل المفاصل بين الفقرات).</li>
                                <li><strong class="text-green-700">مفاصل زلالية (الغالبية):</strong> مرنة وتسمح بحركة واسعة أو محدودة. تحتوي على سائل زلالي وغضاريف لتقليل الاحتكاك (مثل مفصل الركبة والكتف).</li>
                            </ul>
                        </li>
                        <li><strong class="text-red-700">الأربطة:</strong> حزم ليفية قوية تربط العظام ببعضها عند المفاصل وتحدد حركة المفصل.</li>
                        <li><strong class="text-red-700">الأوتار:</strong> نسيج ضام يربط العضلات بالعظام (مثل وتر أخيل الذي يربط العضلة التوأمية بعظمة الكعب).</li>
                    </ul>
                </div>
            </div>

            <!-- 3. الحركة في النبات -->
            <div class="accordion-item bg-white rounded-xl shadow-lg border-t-4 border-yellow-500">
                <button class="accordion-header w-full flex justify-between items-center p-5 text-xl font-extrabold text-gray-800 hover:bg-yellow-50 transition duration-200 rounded-t-xl" onclick="toggleAccordion(this)">
                    <span>3. أنواع وآليات الحركة في النبات</span>
                    <svg class="w-6 h-6 transform transition-transform duration-300 text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="accordion-content bg-gray-50 rounded-b-xl text-gray-700">
                    <p class="mb-3 font-bold text-lg text-yellow-600">تظهر الحركة في النبات بعدة أشكال، بعضها يعتمد على النمو وبعضها على الدعامة الفسيولوجية:</p>
                    <ul class="list-disc pr-5 space-y-2">
                        <li><strong class="text-purple-700">الحركة الدائمة (الدورانية السيتوبلازمية):</strong> حركة مستمرة للسيتوبلازم (حركة دورانية) داخل خلايا النبات الحية، وتشاهد تحت المجهر في خلايا ورقة نبات الإيلوديا. </li>
                        <li><strong class="text-purple-700">حركة اللمس والنوم واليقظة:</strong>
                            <p class="mr-4 mt-1">تحدث في نبات المستحية وغيرها من البقوليات نتيجة تغير ضغط الامتلاء (الدعامة الفسيولوجية) في خلايا الانتفاخات الموجودة عند قواعد الوريقات والأعناق.</p>
                        </li>
                        <li><strong class="text-purple-700">حركة الشد:</strong>
                            <p class="mr-4 mt-1">تكون إما عن طريق <strong class="text-red-600">المحاليق</strong> التي تلتف حول الدعامات ثم تتقلص لسحب الساق لأعلى، أو عن طريق <strong class="text-red-600">جذور الشد</strong> في الأبصال والكورمات لشد الساق تحت سطح التربة. </p>
                        </li>
                        <li><strong class="text-purple-700">الانتحاء:</strong> حركة نمو لأجزاء النبات استجابة لمنبه خارجي (ضوئي، أرضي، مائي).</li>
                    </ul>
                </div>
            </div>

            <!-- 4. الحركة في الإنسان (العضلات) -->
            <div class="accordion-item bg-white rounded-xl shadow-lg border-t-4 border-red-500">
                <button class="accordion-header w-full flex justify-between items-center p-5 text-xl font-extrabold text-gray-800 hover:bg-red-50 transition duration-200 rounded-t-xl" onclick="toggleAccordion(this)">
                    <span>4. آلية الانقباض والانبساط العضلي (نظرية الخيوط المنزلقة)</span>
                    <svg class="w-6 h-6 transform transition-transform duration-300 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="accordion-content bg-gray-50 rounded-b-xl text-gray-700">
                    <p class="mb-3 font-bold text-lg text-red-600">تعتمد الحركة على انقباض وانبساط الألياف العضلية، وتتم وفقاً لنظرية هيو هيكسلي:</p>
                    <ul class="list-decimal pr-5 space-y-3">
                        <li><strong class="text-indigo-700">وصول السيال العصبي:</strong> السيال يصل إلى الوصلة العصبية العضلية ويحفز إطلاق الأستيل كولين.</li>
                        <li><strong class="text-indigo-700">دور الكالسيوم:</strong> تتدفق أيونات الكالسيوم (Ca++) لتقوم بوظيفتين: تحرير الأستيل كولين، وتحفيز تكوين الروابط المستعرضة.</li>
                        <li><strong class="text-indigo-700">تكوين الروابط المستعرضة:</strong> تنطلق الروابط المستعرضة (التي تكونت بمساعدة الكالسيوم) من خيوط الميوسين السميكة وتتصل بخيوط الأكتين الرفيعة.</li>
                        <li><strong class="text-indigo-700">عملية الانقباض:</strong> تعمل الروابط المستعرضة كخطاطيف تسحب خيوط الأكتين باتجاه بعضها البعض (نحو مركز القطعة العضلية)، مما يؤدي إلى:
                            <ul class="list-square pr-5 mt-1 ml-4">
                                <li>قصر طول القطعة العضلية.</li>
                                <li>اختفاء أو قصر المنطقة شبه المضيئة (H).</li>
                                <li>قصر المنطقة المضيئة (I)، بينما يظل طول المنطقة الداكنة (A) ثابتاً.</li>
                            </ul>
                        </li>
                        <li><strong class="text-indigo-700">عملية الانبساط:</strong> يتطلب الانفصال عن الأكتين طاقة (ATP). ترتبط جزيئات ATP بالروابط المستعرضة مما يفك ارتباطها بالأكتين، فترتخي العضلة وتعود الخيوط إلى موضعها الأصلي. [Image of نظرية الخيوط المنزلقة]</li>
                    </ul>
                </div>
            </div>

            <!-- 5. الإجهاد العضلي والوصلة العصبية العضلية -->
            <div class="accordion-item bg-white rounded-xl shadow-lg border-t-4 border-pink-500">
                <button class="accordion-header w-full flex justify-between items-center p-5 text-xl font-extrabold text-gray-800 hover:bg-pink-50 transition duration-200 rounded-t-xl" onclick="toggleAccordion(this)">
                    <span>5. الإجهاد العضلي والشد العضلي والوصلة العصبية</span>
                    <svg class="w-6 h-6 transform transition-transform duration-300 text-pink-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="accordion-content bg-gray-50 rounded-b-xl text-gray-700">
                    <ul class="list-disc pr-5 space-y-3">
                        <li><strong class="text-orange-700">الوصلة العصبية العضلية:</strong> هي منطقة التشابك بين التفرع النهائي للخلية العصبية والليف العضلي. بعد انتهاء الانقباض، يعمل إنزيم الكولين إستريز على تحطيم الأستيل كولين لعودة غشاء الليف العضلي إلى حالة الراحة.</li>
                        <li><strong class="text-orange-700">الإجهاد والتعب العضلي:</strong>
                            <p class="mr-4 mt-1">ينتج عن نقص إمداد الأكسجين للعضلات أثناء المجهود الشاق، مما يضطرها للتنفس اللاهوائي. ينتج عن ذلك تراكم <strong class="text-red-600">حمض اللاكتيك</strong> (يسبب الإجهاد) وتوليد كمية قليلة من <strong class="text-red-600">ATP</strong>.</p>
                        </li>
                        <li><strong class="text-orange-700">الشد العضلي المؤلم:</strong> حالة أشد من الإجهاد، يحدث نتيجة:
                            <ol class="list-decimal pr-5 mt-1 ml-4">
                                <li>عدم وصول أو نقص جزيئات <strong class="text-red-600">ATP</strong> اللازمة لفصل الروابط المستعرضة عن خيوط الأكتين، فتظل العضلة في حالة انقباض دائم.</li>
                                <li>وصول سيالات عصبية خاطئة من المخ.</li>
                            </ol>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- نهاية حاوية المراجعة -->

        <!-- قسم الكويز (الاختبار الذاتي) -->
        <div class="p-6 bg-white rounded-xl shadow-xl border-t-4 border-purple-600 quiz-box">
            <h2 class="text-2xl font-extrabold text-purple-700 mb-6 text-center">اختبار ذاتي: الدعامة والحركة (10 أسئلة)</h2>
            
            <!-- مكان عرض الأسئلة -->
            <div id="quiz-container">
                <!-- تم إضافة active-quiz-frame class هنا عند بدء الكويز -->
                <div id="question-display" class="bg-purple-50 p-4 rounded-lg shadow-inner mb-6 transition duration-300">
                    <p class="text-lg font-bold text-gray-800" id="current-question-text">اضغط "ابدأ الاختبار" للبدء!</p>
                </div>
                
                <div id="options-container" class="space-y-4">
                    <!-- خيارات الإجابة ستُعرض هنا مع ترقيم -->
                </div>

                <!-- زر الإجابة والتقدم -->
                <button id="next-button" onclick="handleAnswer()" class="w-full mt-6 py-3 bg-purple-600 text-white font-bold text-xl rounded-lg hover:bg-purple-700 transition duration-300 shadow-md disabled:opacity-50" disabled>
                    إرسال الإجابة
                </button>
                
                <!-- زر البدء/إعادة التشغيل -->
                <button id="start-button" onclick="startQuiz()" class="w-full mt-4 py-3 bg-green-500 text-white font-bold text-lg rounded-lg hover:bg-green-600 transition duration-300 shadow-md">
                    ابدأ الاختبار
                </button>
            </div>
            
            <!-- مكان عرض النتيجة -->
            <div id="result-container" class="hidden text-center p-8 bg-blue-100 rounded-lg mt-6">
                <h3 class="text-3xl font-extrabold text-blue-800 mb-4">نتيجتك النهائية</h3>
                <p id="final-score" class="text-5xl font-black text-blue-700 mb-6">0/10</p>
                <p id="score-message" class="text-xl text-gray-700 mb-6"></p>
                <button onclick="startQuiz()" class="py-3 px-6 bg-purple-600 text-white font-bold text-lg rounded-lg hover:bg-purple-700 transition duration-300 shadow-lg">
                    إعادة الاختبار
                </button>
            </div>

        </div>
        <!-- نهاية قسم الكويز -->

        <!-- تذييل -->
        <footer class="mt-12 text-center text-gray-600 text-sm p-4 border-t border-gray-300">
            <p>تم التصميم للمراجعة والتركيز على النقاط الأساسية للفصل الأول.</p>
        </footer>

    </div>

    <script>
        // مصفوفة الأسئلة
        const quizQuestions = [
            {
                question: "أي مما يلي يعتمد بشكل أساسي على خاصية الأسموزية (دخول الماء)؟",
                options: ["ترسيب الكيوتين على البشرة", "انتفاخ بذور البقوليات الجافة", "وجود اللجنين في الألياف", "ارتباط الأربطة ببعضها"],
                answer: 1 
            },
            {
                question: "عدد عظام الهيكل المحوري في الإنسان هو:",
                options: ["206 عظمة", "126 عظمة", "80 عظمة", "33 عظمة"],
                answer: 2 
            },
            {
                question: "المادة التي تترسب على جدر خلايا البشرة الخارجية للنبات للحد من فقدان الماء هي:",
                options: ["السيوبرين", "السليلوز", "الكيوتين", "اللجنين"],
                answer: 2 
            },
            {
                question: "المفصل الذي يسمح بحركة محدودة جداً ويفصل بين فقرات العمود الفقري هو مفصل:",
                options: ["ليفي", "زلالي واسع", "غضروفي", "زلالي محدود"],
                answer: 2 
            },
            {
                question: "النسيج الضام الذي يربط العضلات بالعظام (مثل وتر أخيل) هو:",
                options: ["الغضاريف", "الأربطة", "الأوتار", "النخاع العظمي"],
                answer: 2 
            },
            {
                question: "سبب استمرار انقباض العضلة (حالة الشد العضلي المؤلم) هو نقص جزيئات:",
                options: ["أيونات الكالسيوم", "الأستيل كولين", "حمض اللاكتيك", "ATP"],
                answer: 3 
            },
            {
                question: "في نظرية الخيوط المنزلقة، ما هو التركيب الذي ينطلق من خيوط الميوسين ليتصل بخيوط الأكتين؟",
                options: ["الألياف العضلية", "الروابط المستعرضة", "الخطوط Z", "الأقراص المضيئة"],
                answer: 1 
            },
            {
                question: "الحركة التي تعتمد على تغير ضغط الامتلاء في خلايا نبات المستحية هي حركة:",
                options: ["الانتحاء الضوئي", "الشد بالمحاليق", "الدورانية السيتوبلازمية", "اللمس والنوم"],
                answer: 3 
            },
            {
                question: "أثناء الانقباض العضلي، ماذا يحدث للمنطقة شبه المضيئة (H)؟",
                options: ["يزداد طولها", "يظل طولها ثابتاً", "تختفي أو تقصر", "تتحول إلى منطقة داكنة"],
                answer: 2 
            },
            {
                question: "عند نقص الأكسجين في العضلة، تتراكم مادة عضوية تسبب الإجهاد هي:",
                options: ["حمض البيروفيك", "حمض اللاكتيك", "الجلوكوز", "الإنزيم الكولين إستريز"],
                answer: 1 
            }
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let selectedOption = null;

        const reviewContainer = document.getElementById('review-container');
        const reviewTitle = document.getElementById('review-title');
        const quizContainer = document.getElementById('quiz-container');
        const resultContainer = document.getElementById('result-container');
        const questionDisplay = document.getElementById('question-display');
        const questionText = document.getElementById('current-question-text');
        const optionsContainer = document.getElementById('options-container');
        const nextButton = document.getElementById('next-button');
        const startButton = document.getElementById('start-button');
        const finalScore = document.getElementById('final-score');
        const scoreMessage = document.getElementById('score-message');


        // دالة عرض الأسئلة
        function displayQuestion() {
            if (currentQuestionIndex < quizQuestions.length) {
                const q = quizQuestions[currentQuestionIndex];
                questionText.textContent = `السؤال ${currentQuestionIndex + 1} من ${quizQuestions.length}: ${q.question}`;
                optionsContainer.innerHTML = '';
                selectedOption = null;
                nextButton.disabled = true;
                nextButton.textContent = 'إرسال الإجابة';

                q.options.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    // space-x-reverse لدعم تخطيط RTL
                    optionDiv.className = 'flex items-center space-x-3 space-x-reverse'; 

                    const numberSpan = document.createElement('span');
                    numberSpan.textContent = `${index + 1}.`;
                    // وسم الـ w-8 لضمان مساحة ثابتة للرقم
                    numberSpan.className = 'text-xl font-bold text-purple-700 w-8 flex-shrink-0';

                    const button = document.createElement('button');
                    button.textContent = option;
                    button.className = 'option-btn';
                    button.setAttribute('data-index', index);
                    button.onclick = () => selectOption(button, index);

                    optionDiv.appendChild(numberSpan);
                    optionDiv.appendChild(button);
                    optionsContainer.appendChild(optionDiv);
                });
            } else {
                showResults();
            }
        }

        // دالة اختيار الإجابة
        function selectOption(button, index) {
            // **رسالة لتأكيد التشغيل** - ستظهر في Console Log المتصفح
            console.log(`تم اختيار الخيار: المؤشر ${index + 1}, النص: ${button.textContent}`); 

            // إزالة التحديد من جميع الخيارات
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.classList.remove('selected');
            });

            // تحديد الخيار الحالي وإضافة علامة (selected class)
            button.classList.add('selected');
            selectedOption = index;
            nextButton.disabled = false;
        }

        // دالة التعامل مع الإجابة والتحقق منها
        function handleAnswer() {
            if (selectedOption === null) return;

            const q = quizQuestions[currentQuestionIndex];
            const correctIndex = q.answer;
            const isCorrect = selectedOption === correctIndex;

            // تحديد الأزرار وتلوينها
            document.querySelectorAll('.option-btn').forEach(btn => {
                const btnIndex = parseInt(btn.getAttribute('data-index'));
                btn.disabled = true; // إيقاف التفاعل بعد الإجابة
                btn.classList.remove('selected'); // إزالة إطار التحديد

                if (btnIndex === correctIndex) {
                    btn.classList.add('correct');
                } else if (btnIndex === selectedOption) {
                    btn.classList.add('incorrect');
                }
            });
            
            // تحديث النتيجة
            if (isCorrect) {
                score++;
            }

            nextButton.textContent = 'السؤال التالي >>';
            nextButton.disabled = false;
            nextButton.onclick = goToNextQuestion;
        }

        // دالة الانتقال للسؤال التالي
        function goToNextQuestion() {
            currentQuestionIndex++;
            nextButton.onclick = handleAnswer; // إعادة تعيين الدالة لـ handleAnswer
            document.querySelectorAll('.option-btn').forEach(btn => btn.disabled = false); // تفعيل الأزرار للسؤال الجديد
            displayQuestion();
        }

        // دالة عرض النتائج
        function showResults() {
            // إزالة الإطار الأسود حول السؤال
            questionDisplay.classList.remove('active-quiz-frame');
            
            quizContainer.classList.add('hidden');
            resultContainer.classList.remove('hidden');
            
            finalScore.textContent = `${score}/${quizQuestions.length}`;
            
            let message = '';
            const percentage = (score / quizQuestions.length) * 100;

            if (percentage >= 90) {
                message = "ممتاز! إتقان عالٍ للمادة، استمر على هذا المستوى.";
            } else if (percentage >= 70) {
                message = "جيد جداً! لديك فهم قوي، راجع النقاط القليلة التي أخطأت فيها.";
            } else if (percentage >= 50) {
                message = "جيد! أنت على الطريق الصحيح، تحتاج إلى مراجعة شاملة لبعض الأقسام.";
            } else {
                message = "تحتاج إلى تركيز أكبر. قم بمراجعة الأقسام التفصيلية في الأعلى ثم أعد الاختبار.";
            }
            scoreMessage.textContent = message;

            // عند الانتهاء من الكويز، أظهر قسم المراجعة مرة أخرى
            reviewContainer.classList.remove('hidden');
            reviewTitle.classList.remove('hidden');
        }

        // دالة بدء الاختبار
        function startQuiz() {
            // إخفاء قسم المراجعة والشرح عند البدء
            reviewContainer.classList.add('hidden');
            reviewTitle.classList.add('hidden');
            // إضافة الإطار الأسود حول السؤال
            questionDisplay.classList.add('active-quiz-frame');

            currentQuestionIndex = 0;
            score = 0;
            selectedOption = null;
            
            quizContainer.classList.remove('hidden');
            resultContainer.classList.add('hidden');
            startButton.classList.add('hidden'); 
            
            displayQuestion();
        }


        // دالة JavaScript لفتح وإغلاق أقسام المراجعة (Accordion)
        function toggleAccordion(button) {
            const item = button.parentElement;
            const content = button.nextElementSibling;
            const icon = button.querySelector('svg');

            // إغلاق كل الأقسام ما عدا القسم الحالي
            document.querySelectorAll('.accordion-item').forEach(otherItem => {
                if (otherItem !== item) {
                    otherItem.classList.remove('active');
                    otherItem.querySelector('.accordion-content').style.maxHeight = 0;
                    otherItem.querySelector('svg').classList.remove('rotate-180');
                }
            });

            // تبديل حالة القسم الحالي
            if (item.classList.contains('active')) {
                item.classList.remove('active');
                content.style.maxHeight = 0;
                icon.classList.remove('rotate-180');
            } else {
                item.classList.add('active');
                // نستخدم scrollHeight لتعيين ارتفاع المحتوى بدقة
                content.style.maxHeight = content.scrollHeight + "px";
                icon.classList.add('rotate-180');
            }
        }

        // تحديث maxHeight عند تغيير حجم الشاشة (لضمان الاستجابة الكاملة)
        window.addEventListener('resize', () => {
            document.querySelectorAll('.accordion-item.active .accordion-content').forEach(content => {
                content.style.maxHeight = content.scrollHeight + "px";
            });
        });

        // تشغيل أول قسم عند التحميل
        window.onload = () => {
             const firstButton = document.querySelector('.accordion-header');
             if (firstButton) {
                 toggleAccordion(firstButton);
             }
        };
    </script>
</body>
</html>
